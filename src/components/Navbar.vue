<template>
  <div class="navbar">
    <nav>
      <h1>
        <router-link :to="{ name: 'home' }">
          <svg id="a" xmlns="http://www.w3.org/2000/svg" width="650.53" height="161.47" viewBox="0 0 650.53 161.47">
            <g>
              <path d="M112.74,19.04c-25.91-25.51-67.58-25.39-93.34,.36-25.75,25.75-25.87,67.43-.36,93.34L112.74,19.04Z"
                fill="#001e41" />
              <path d="M5.42,142.43c25.91,25.51,67.58,25.39,93.34-.36s25.87-67.43,.36-93.34L5.42,142.43Z"
                fill="#001e41" />
            </g>
            <g>
              <path
                d="M150.16,55.64h11.61c.52,4.7,3.59,6.65,9.13,6.65,3.78,0,7.5-1.37,7.5-4.89,0-3.72-3.78-4.5-10.18-6.07-8.09-1.89-16.63-4.37-16.63-14.15s8.09-14.35,18.52-14.35,17.94,4.57,18.39,14.35h-11.28c-.46-3.59-3.2-5.61-7.5-5.61-4.04,0-6.72,1.76-6.72,4.37,0,3.26,3.59,4.04,10.57,5.61,8.67,2.02,16.5,4.7,16.5,14.68s-8.35,15.2-19.11,15.2c-12.39,0-20.55-5.48-20.81-15.78Z"
                fill="#001e41" />
              <path d="M194.77,23.68h35.35v9.52h-23.81v8.35h20.42v9h-20.42v9.98h24.2v9.78h-35.75V23.68Z"
                fill="#001e41" />
              <path d="M235.72,23.68h11.55V60.53h20.94v9.78h-32.48V23.68Z" fill="#001e41" />
              <path d="M272.57,23.68h34.7v9.72h-23.16v9.46h19.37v9.33h-19.37v18.13h-11.55V23.68Z" fill="#001e41" />
              <path
                d="M152.37,88.9h22.31c9.26,0,16.31,4.76,16.31,13.44,0,5.41-2.67,9.39-8.09,11.28v.2c4.04,1.37,6.13,3.91,6.78,8.54,.98,6.13,.33,12,1.96,12.59v.59h-11.22c-1.24-.72-1.04-6.2-1.76-10.83-.59-4.31-2.8-6.65-7.76-6.65h-6.98v17.48h-11.55v-46.64Zm20.22,20.61c4.57,0,6.91-2.15,6.91-5.67s-2.22-5.81-6.65-5.81h-8.94v11.48h8.67Z"
                fill="#001e41" />
              <path d="M196.14,88.9h35.35v9.52h-23.81v8.35h20.42v9h-20.42v9.98h24.2v9.78h-35.75v-46.64Z"
                fill="#001e41" />
              <path d="M237.09,88.9h11.55v36.85h20.94v9.78h-32.48v-46.64Z" fill="#001e41" />
              <path
                d="M288.1,88.9h11.87l16.83,46.64h-12.13l-2.74-8.41h-16.31l-2.67,8.41h-11.61l16.76-46.64Zm11.15,29.94l-3.52-11.28c-.78-2.41-1.83-6.59-1.83-6.59h-.13s-1.11,4.17-1.89,6.59l-3.59,11.28h10.96Z"
                fill="#001e41" />
              <path d="M325.66,98.68h-13.57v-9.78h38.81v9.78h-13.7v36.85h-11.55v-36.85Z" fill="#001e41" />
              <path d="M355.27,88.9h11.55v46.64h-11.55v-46.64Z" fill="#001e41" />
              <path
                d="M371.32,112.31c0-13.96,8.94-24.33,23.03-24.33s23.09,10.37,23.09,24.33-8.94,24.33-23.09,24.33-23.03-10.37-23.03-24.33Zm34.38,0c0-8.48-3.72-15-11.28-15s-11.35,6.52-11.35,15,3.85,14.94,11.35,14.94,11.28-6.46,11.28-14.94Z"
                fill="#001e41" />
              <path
                d="M421.93,88.9h11.61l13.83,23.42c.72,1.3,3.2,5.94,3.2,5.94h.13s-.13-5.61-.13-7.24v-22.11h11.28v46.64h-11.61l-13.7-23.09c-.78-1.24-3.33-6.26-3.33-6.26h-.13s.13,6,.13,7.63v21.72h-11.28v-46.64Z"
                fill="#001e41" />
              <path
                d="M481.74,88.9h11.87l16.83,46.64h-12.13l-2.74-8.41h-16.31l-2.67,8.41h-11.61l16.76-46.64Zm11.15,29.94l-3.52-11.28c-.78-2.41-1.83-6.59-1.83-6.59h-.13s-1.11,4.17-1.89,6.59l-3.59,11.28h10.96Z"
                fill="#001e41" />
              <path d="M513.69,88.9h11.55v36.85h20.94v9.78h-32.48v-46.64Z" fill="#001e41" />
              <path d="M550.61,88.9h11.55v46.64h-11.55v-46.64Z" fill="#001e41" />
              <path d="M580.02,98.68h-13.57v-9.78h38.81v9.78h-13.7v36.85h-11.55v-36.85Z" fill="#001e41" />
              <path
                d="M623.2,118.32l-15.78-29.42h12.59l6,12.07c1.57,3.2,3.07,7.11,3.07,7.11h.13s1.63-3.91,3.2-7.11l5.94-12.07h12.2l-15.78,29.42v17.22h-11.54v-17.22Z"
                fill="#001e41" />
            </g>
          </svg>
        </router-link>
      </h1>
      <div class="links">
        <div v-if="displayName">
          
          <!-- <span> Hi there, {{ displayName }}</span> -->

           <div id="nav-container">
                <div class="bg"></div>
                <div class="button" tabindex="0">
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </div>

                <div id="nav-content" tabindex="0">
                  <ul>
                    <li v-if="isAdmin">
                      <router-link class="btn" :to="{ name: 'VideoAdmin' }">Video Admin</router-link>
                  </li>
                    <li><button @click="handleClick">Logout</button></li>
                  </ul>
                </div>
            </div>
        
        </div>
        <div v-else>
          
            <router-link class="btn" :to="{ name: 'Signup' }">Signup</router-link>
            <router-link class="btn" :to="{ name: 'Login' }">Login</router-link>
          
        </div>
        
      </div>
      
    </nav>
  </div>
  <!-- <div v-if="ModuleShow">
          <ModalMenu @modalClose="modalClose"/>
        </div> -->
</template>

<script>
import useLogout from '../composables/useLogout'
import { useRouter} from 'vue-router'
import getUser from '@/composables/getUser'
import { ref} from '@vue/reactivity'
import { userStore } from '@/store/userStore'
import { coursesStore } from '@/store/coursesStore'
import ModalMenu from './ModalMenu.vue'

export default {
    components: { ModalMenu },
    setup(props, context) {
      const store = userStore()
      const cstore = coursesStore()
        const {logout, error } = useLogout()
        const router = useRouter()
        const isAdmin = ref()
        const displayName = ref()
        const ModuleShow = ref(false)

        store.$subscribe((login, state)=>{
          displayName.value = store.displayName
          isAdmin.value = store.admin
        })

        const showModule = () =>{
          ModuleShow.value=true;
        }

        const modalClose = () =>{
          ModuleShow.value=false
        }

        const handleClick =async () => {
            store.$reset()
            cstore.$reset()
            await logout()
            router.push({ name: 'Login'})
        }

    return { handleClick, isAdmin, displayName, showModule, ModuleShow, modalClose }
    }
}
</script>

<style scoped>
  .navbar {
    padding: 16px 10px;
    margin: 0 10px 40px 10px;
    background: white;
    border-bottom: 1px solid var(--lines);
  }

  .navbar svg {
    height:75px;
    width:300px;
  }
  nav {
    display: flex;
    align-items: center;
    margin: 0 20px;
  }

  .nav_row{
    display: flex;
  }
 
  nav .links {
    margin-left: auto;
  }
 
  nav .links a, button {
    margin-left: 16px;
    font-size: 14px;
  }
  span {
    font-size: 14px;
    display: inline-block;
    margin-left: 16px;
    padding-left: 16px;
    border-left: 1px solid #eee;
  }

 

  #nav-container {
  position: fixed;
  margin-left: -140px;
  height: 100vh;
  width: 500px;
  pointer-events: none;
}
/* #nav-container .bg {
  position: absolute;
  top: 70px;
  left: 0;
  width: 100%;
  height: calc(100% - 70px);
  visibility: hidden;
  opacity: 0;
  transition: .3s;
  background: #000;
}
#nav-container:focus-within .bg {
  visibility: visible;
  opacity: .6;
} */
#nav-container * {
  visibility: visible;
}

.button {
  position: relative;
  display: flex;
  flex-direction: column;
  justify-content: center;
  z-index: 1;
  -webkit-appearance: none;
  border: 0;
  background: transparent;
  border-radius: 0;
  width: 30px;
  cursor: pointer;
  pointer-events: auto;
  margin-left: 55px;
  touch-action: manipulation;
  -webkit-tap-highlight-color: rgba(0,0,0,0);
}
.icon-bar {
  display: block;
  width: 100%;
  height: 3px;
  background: #001e41;
  transition: .3s;
}
.icon-bar + .icon-bar {
  margin-top: 5px;
}

#nav-container:focus-within .button {
  pointer-events: none;
}
#nav-container:focus-within .icon-bar:nth-of-type(1) {
  transform: translate3d(0,8px,0) rotate(45deg);
}
#nav-container:focus-within .icon-bar:nth-of-type(2) {
  opacity: 0;
}
#nav-container:focus-within .icon-bar:nth-of-type(3) {
  transform: translate3d(0,-8px,0) rotate(-45deg);
}

#nav-content {
  margin-top: 60px;
  margin-left:10x;
  padding: 20px;
  
  max-width: 300px;
  position: absolute;
  top: 0;
 
  height: calc(100% - 60px);
  background: #ececec;
  pointer-events: auto;
  -webkit-tap-highlight-color: rgba(0,0,0,0);
  transform: translateX(100%);
  transition: transform .3s;
  will-change: transform;
  contain: paint;
}

#nav-content ul {
  height: 100%;
  display: flex;
  flex-direction: column;
  list-style-type: none;
}

#nav-content li  {
  padding: 10px 5px;
  display: block;
  text-transform: uppercase;
  transition: color .1s;
}


#nav-container:focus-within #nav-content {
  transform: none;
}
</style>