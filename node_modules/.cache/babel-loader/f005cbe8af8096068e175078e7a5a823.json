{"ast":null,"code":"import _objectSpread from \"/Users/mattfrawley/sites/srsite/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport { ref } from 'vue';\nimport { db } from '../firebase/config';\nimport { collection, onSnapshot, query, where } from 'firebase/firestore';\n\nvar getOrderDocs = function getOrderDocs(c, keyField, fieldValue) {\n  var documents = ref(null);\n  var error = ref(null); // register the firestore collection reference\n\n  var colRef = collection(db, c);\n\n  if (keyField === 'course') {\n    colRef = query(colRef, where(\"course\", \"==\", fieldValue));\n  } else {\n    colRef = query(colRef, where(\"module\", \"==\", fieldValue));\n  }\n\n  var unsub = onSnapshot(colRef, function (snap) {\n    var results = [];\n    snap.docs.forEach(function (doc) {\n      // must wait for the server to create the timestamp & send it back\n      results.push(_objectSpread(_objectSpread({}, doc.data()), {}, {\n        id: doc.id\n      }));\n    }); // update values\n\n    documents.value = results; // update values\n\n    if (keyField === 'course') {\n      documents.value.sort(function (a, b) {\n        return a.module > b.module ? 1 : -1;\n      });\n    } else {\n      documents.value.sort(function (a, b) {\n        return a.order > b.order ? 1 : -1;\n      });\n    }\n\n    error.value = null;\n  }, function (err) {\n    console.log(err.message);\n    documents.value = null;\n    error.value = 'could not fetch the data';\n  });\n  console.log('and here are documents: ', documents);\n  return {\n    error: error,\n    documents: documents\n  };\n};\n\nexport default getOrderDocs;","map":{"version":3,"names":["ref","db","collection","onSnapshot","query","where","getOrderDocs","c","keyField","fieldValue","documents","error","colRef","unsub","snap","results","docs","forEach","doc","push","data","id","value","sort","a","b","module","order","err","console","log","message"],"sources":["/Users/mattfrawley/sites/srsite/src/composables/getOrderDocs.js"],"sourcesContent":["import { ref } from 'vue'\nimport { db } from '../firebase/config'\nimport { collection, onSnapshot, query, where } from 'firebase/firestore'\n\nconst getOrderDocs = (c, keyField, fieldValue) => {\n\n  const documents = ref(null)\n  const error = ref(null)\n\n  // register the firestore collection reference\n  let colRef = collection(db, c)\n  if (keyField==='course'){\n     colRef = query(colRef, where(\"course\", \"==\", fieldValue))\n  } else {\n     colRef = query(colRef, where(\"module\", \"==\", fieldValue))\n  }\n \n    \n  const unsub = onSnapshot(colRef, snap => {\n    let results = []\n    snap.docs.forEach(doc => {\n      // must wait for the server to create the timestamp & send it back\n      results.push({...doc.data(), id: doc.id})\n    });\n\n    // update values\n    documents.value = results\n    \n    // update values\n    if (keyField==='course') {\n      documents.value.sort((a, b) => (a.module > b.module) ? 1 : -1)\n    } else {\n      documents.value.sort((a, b) => (a.order > b.order) ? 1 : -1)\n    }\n    \n    \n    error.value = null\n  }, err => {\n    console.log(err.message)\n    documents.value = null\n    error.value = 'could not fetch the data'\n  })\n  console.log('and here are documents: ', documents)\n  return { error, documents }\n}\n\nexport default getOrderDocs"],"mappings":";;;;;AAAA,SAASA,GAAT,QAAoB,KAApB;AACA,SAASC,EAAT,QAAmB,oBAAnB;AACA,SAASC,UAAT,EAAqBC,UAArB,EAAiCC,KAAjC,EAAwCC,KAAxC,QAAqD,oBAArD;;AAEA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAACC,CAAD,EAAIC,QAAJ,EAAcC,UAAd,EAA6B;EAEhD,IAAMC,SAAS,GAAGV,GAAG,CAAC,IAAD,CAArB;EACA,IAAMW,KAAK,GAAGX,GAAG,CAAC,IAAD,CAAjB,CAHgD,CAKhD;;EACA,IAAIY,MAAM,GAAGV,UAAU,CAACD,EAAD,EAAKM,CAAL,CAAvB;;EACA,IAAIC,QAAQ,KAAG,QAAf,EAAwB;IACrBI,MAAM,GAAGR,KAAK,CAACQ,MAAD,EAASP,KAAK,CAAC,QAAD,EAAW,IAAX,EAAiBI,UAAjB,CAAd,CAAd;EACF,CAFD,MAEO;IACJG,MAAM,GAAGR,KAAK,CAACQ,MAAD,EAASP,KAAK,CAAC,QAAD,EAAW,IAAX,EAAiBI,UAAjB,CAAd,CAAd;EACF;;EAGD,IAAMI,KAAK,GAAGV,UAAU,CAACS,MAAD,EAAS,UAAAE,IAAI,EAAI;IACvC,IAAIC,OAAO,GAAG,EAAd;IACAD,IAAI,CAACE,IAAL,CAAUC,OAAV,CAAkB,UAAAC,GAAG,EAAI;MACvB;MACAH,OAAO,CAACI,IAAR,iCAAiBD,GAAG,CAACE,IAAJ,EAAjB;QAA6BC,EAAE,EAAEH,GAAG,CAACG;MAArC;IACD,CAHD,EAFuC,CAOvC;;IACAX,SAAS,CAACY,KAAV,GAAkBP,OAAlB,CARuC,CAUvC;;IACA,IAAIP,QAAQ,KAAG,QAAf,EAAyB;MACvBE,SAAS,CAACY,KAAV,CAAgBC,IAAhB,CAAqB,UAACC,CAAD,EAAIC,CAAJ;QAAA,OAAWD,CAAC,CAACE,MAAF,GAAWD,CAAC,CAACC,MAAd,GAAwB,CAAxB,GAA4B,CAAC,CAAvC;MAAA,CAArB;IACD,CAFD,MAEO;MACLhB,SAAS,CAACY,KAAV,CAAgBC,IAAhB,CAAqB,UAACC,CAAD,EAAIC,CAAJ;QAAA,OAAWD,CAAC,CAACG,KAAF,GAAUF,CAAC,CAACE,KAAb,GAAsB,CAAtB,GAA0B,CAAC,CAArC;MAAA,CAArB;IACD;;IAGDhB,KAAK,CAACW,KAAN,GAAc,IAAd;EACD,CAnBuB,EAmBrB,UAAAM,GAAG,EAAI;IACRC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,OAAhB;IACArB,SAAS,CAACY,KAAV,GAAkB,IAAlB;IACAX,KAAK,CAACW,KAAN,GAAc,0BAAd;EACD,CAvBuB,CAAxB;EAwBAO,OAAO,CAACC,GAAR,CAAY,0BAAZ,EAAwCpB,SAAxC;EACA,OAAO;IAAEC,KAAK,EAALA,KAAF;IAASD,SAAS,EAATA;EAAT,CAAP;AACD,CAxCD;;AA0CA,eAAeJ,YAAf"},"metadata":{},"sourceType":"module"}